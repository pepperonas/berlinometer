<!DOCTYPE html><html lang="de"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Pixel Color Monitor</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background-color:#1a1b21;color:#e0e0e0;padding:20px;min-height:100vh}.container{max-width:800px;margin:0 auto;background-color:#2C2E3B;border-radius:12px;padding:30px;box-shadow:0 8px 32px rgba(0,0,0,0.3)}h1{color:#ffffff;margin-bottom:30px;font-size:28px;text-align:center}.control-panel{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:30px}.input-group{display:flex;flex-direction:column;gap:8px}label{color:#b0b0b0;font-size:14px;font-weight:500}input[type="number"]{background-color:#1a1b21;border:2px solid #404252;color:#e0e0e0;padding:10px 15px;border-radius:8px;font-size:16px;transition:border-color 0.3s}input[type="number"]:focus{outline:none;border-color:#5865F2}.button-group{display:flex;gap:15px;margin-bottom:30px}button{flex:1;padding:12px 24px;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all 0.3s;color:#ffffff}.btn-start{background-color:#5865F2}.btn-start:hover:not(:disabled){background-color:#4752C4;transform:translateY(-1px)}.btn-stop{background-color:#ED4245}.btn-stop:hover:not(:disabled){background-color:#C03537;transform:translateY(-1px)}button:disabled{opacity:0.5;cursor:not-allowed;transform:none !important}.preview-area{background-color:#1a1b21;border-radius:8px;padding:20px;margin-bottom:20px;text-align:center;position:relative}#preview{max-width:100%;max-height:500px;border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.3);background:#000}.color-display{display:flex;align-items:center;justify-content:center;gap:20px;padding:20px;background-color:#1a1b21;border-radius:8px;margin-bottom:20px}.active-areas{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px;padding:20px;background-color:#1a1b21;border-radius:8px;margin-bottom:20px;max-height:300px;overflow-y:auto}.area-card{background-color:#2C2E3B;border-radius:8px;padding:15px;border:2px solid #404252;transition:all 0.3s ease;cursor:pointer;position:relative}.area-card:hover{border-color:#FF4444;box-shadow:0 0 15px rgba(255,68,68,0.5)}.area-card.active{border-color:#F0B232;box-shadow:0 0 10px rgba(240,178,50,0.3)}.area-info{display:flex;align-items:center;gap:10px;margin-bottom:8px}.area-color{width:20px;height:20px;border-radius:4px;border:1px solid #404252}.area-pos{font-family:'Courier New',monospace;font-size:12px;color:#7289DA}.area-change{font-family:'Courier New',monospace;font-size:11px;color:#F0B232;margin-top:5px}select{background-color:#1a1b21;border:2px solid #404252;color:#e0e0e0;padding:10px 15px;border-radius:8px;font-size:16px;transition:border-color 0.3s}select:focus{outline:none;border-color:#5865F2}.dialog-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.8);display:flex;justify-content:center;align-items:center;z-index:1000}.dialog{background-color:#2C2E3B;border-radius:12px;padding:30px;max-width:500px;width:90%;border:2px solid #404252;box-shadow:0 20px 60px rgba(0,0,0,0.5)}.dialog h2{color:#ffffff;margin-bottom:20px;text-align:center}.dialog-form{display:flex;flex-direction:column;gap:20px}.dialog input[type="text"],.dialog input[type="number"]{background-color:#1a1b21;border:2px solid #404252;color:#e0e0e0;padding:10px 15px;border-radius:8px;font-size:16px;transition:border-color 0.3s;width:100%;box-sizing:border-box}.dialog input[type="text"]:focus,.dialog input[type="number"]:focus{outline:none;border-color:#5865F2}.dialog-buttons{display:flex;gap:15px;justify-content:flex-end;margin-top:25px}.dialog-buttons button{padding:10px 20px;border:none;border-radius:6px;cursor:pointer;font-weight:600}.btn-cancel{background-color:#6c757d;color:white}.btn-track{background-color:#28a745;color:white}.tracking-section{background-color:#1a1b21;border-radius:8px;padding:20px;margin-bottom:20px;display:none}.tracking-item{background-color:#2C2E3B;border-radius:8px;padding:15px;margin-bottom:15px;border:2px solid #404252}.tracking-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.tracking-title{color:#ffffff;font-weight:600;font-size:16px}.tracking-status{padding:5px 10px;border-radius:15px;font-size:12px;font-weight:600}.tracking-status.active{background-color:#28a745;color:white}.tracking-status.inactive{background-color:#6c757d;color:white}.tracking-info{color:#b0b0b0;font-size:14px;margin-bottom:10px}.tracking-history{max-height:150px;overflow-y:auto;background-color:#1a1b21;border-radius:6px;padding:10px}.history-entry{display:flex;justify-content:space-between;align-items:center;padding:5px 0;border-bottom:1px solid #404252;font-family:'Courier New',monospace;font-size:12px}.history-entry:last-child{border-bottom:none}.history-entry.changed{color:#F0B232}.history-entry.unchanged{color:#7289DA}.tracking-controls{display:flex;gap:10px;margin-top:10px}.tracking-controls button{padding:5px 15px;font-size:12px;border-radius:4px}.footer{text-align:center;padding:20px;margin-top:30px;border-top:1px solid #404252;color:#7289DA;font-size:14px}.footer a{color:#5865F2;text-decoration:none}.footer a:hover{text-decoration:underline}.color-box{display:block;width:80px;height:80px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.3);border:2px solid #404252;transition:background-color 0.2s ease;background-color:#1a1b21}.color-info{text-align:left}.color-info h3{color:#ffffff;margin-bottom:8px}.color-value{font-family:'Courier New',monospace;color:#b0b0b0;margin:4px 0}.log-container{background-color:#1a1b21;border-radius:8px;padding:20px;max-height:300px;overflow-y:auto}.log-container h3{color:#ffffff;margin-bottom:15px}.log-entry{padding:8px 12px;margin-bottom:8px;background-color:#2C2E3B;border-radius:6px;font-family:'Courier New',monospace;font-size:14px;display:flex;justify-content:space-between;align-items:center}.log-entry.change{border-left:3px solid #F0B232}.timestamp{color:#7289DA;font-size:12px}.message{color:#969696;text-align:center;padding:40px;font-size:18px}.crosshair{position:absolute;width:30px;height:30px;border:2px solid #F0B232;border-radius:50%;pointer-events:none;transform:translate(-50%,-50%);box-shadow:0 0 10px rgba(240,178,50,0.5)}.crosshair::before,.crosshair::after{content:'';position:absolute;background-color:#F0B232}.crosshair::before{width:1px;height:10px;left:50%;top:-5px;transform:translateX(-50%)}.crosshair::after{height:1px;width:10px;top:50%;left:-5px;transform:translateY(-50%)}</style></head><body><div class="container"><h1>üéØ Pixel Color Monitor</h1><div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:25px;"><div style="background-color:#2C2E3B;border-radius:8px;padding:20px;border:2px solid #404252;"><h3 style="color:#ffffff;margin-bottom:15px;font-size:18px;">üìã Funktionsumfang</h3><p style="color:#b0b0b0;margin:0;line-height:1.5;">Dieses Tool erm√∂glicht die √úberwachung von Farbver√§nderungen auf dem Bildschirm in Echtzeit. Es bietet automatische Multi-Bereich-Scans, individuelle Trackings mit √Ñnderungshistorie und Export-Funktionen f√ºr Analyse-Daten.</p></div><div style="background-color:#2C2E3B;border-radius:8px;padding:20px;border:2px solid #404252;"><h4 style="color:#ED4245;margin-bottom:10px;font-size:16px;">‚ö†Ô∏è WICHTIGER DISCLAIMER</h4><p style="color:#e0e0e0;font-size:13px;line-height:1.4;margin:0;">Dieses Tool darf ausschlie√ülich zu <strong>Lehr- und Testzwecken</strong> verwendet werden. Die Nutzung zur √úberwachung von Webkonferenzen, privaten Inhalten oder zur Verletzung der Privatsph√§re anderer Personen ist <strong>unethisch und strengstens zu unterlassen</strong>. Der Nutzer tr√§gt die volle Verantwortung f√ºr die rechtm√§√üige Verwendung.</p></div></div><div class="control-panel"><div class="input-group"><label for="scanMode">Scan-Modus</label><select id="scanMode"><option value="auto">Automatisch (ganzer Bildschirm)</option><option value="grid">Grid (9x9 Punkte)</option><option value="center">Bildschirm-Zentrum</option><option value="manual">Manuelle Position</option></select></div><div class="input-group" id="manualControls" style="display:none;"><label for="xPos">X-Position</label><input type="number" id="xPos" value="500" min="0"></div><div class="input-group" id="manualControls2" style="display:none;"><label for="yPos">Y-Position</label><input type="number" id="yPos" value="300" min="0"></div><div class="input-group"><label for="interval">Intervall (ms)</label><input type="number" id="interval" value="200" min="50" max="5000" step="50"></div><div class="input-group"><label for="threshold">√Ñnderungs-Schwellwert</label><input type="number" id="threshold" value="10" min="0" max="255"></div><div class="input-group"><label for="sensitivity">Empfindlichkeit</label><select id="sensitivity"><option value="low">Niedrig (gro√üe √Ñnderungen)</option><option value="medium" selected>Mittel</option><option value="high">Hoch (kleinste √Ñnderungen)</option></select></div></div><div class="button-group"><button id="startBtn" class="btn-start">Monitor starten</button><button id="stopBtn" class="btn-stop" disabled>Monitor stoppen</button></div><div class="button-group" style="margin-top:-15px;margin-bottom:30px;"><button id="testBtn" style="background-color:#5865F2;opacity:0.7;" onclick="window.testDraw && window.testDraw()">Test Frame zeichnen</button><button id="scanBtn" style="background-color:#5865F2;opacity:0.7;" onclick="window.scanPixels && window.scanPixels()">Pixel-Scan (5x5)</button><button id="findBtn" style="background-color:#43B581;opacity:0.7;" onclick="window.findActiveArea && window.findActiveArea()">Aktiven Bereich finden</button></div><div class="preview-area"><div style="position:absolute;top:10px;right:10px;z-index:10;"><span id="liveIndicator" style="display:none;background:#43B581;color:white;padding:5px 10px;border-radius:5px;font-size:12px;">‚óè LIVE</span></div><canvas id="preview" style="display:none;"></canvas><div id="placeholder" class="message">Klicke "Monitor starten" um die Bildschirm√ºberwachung zu beginnen</div></div><div class="active-areas" style="display:none;" id="activeAreas"><h3 style="grid-column:1/-1;color:#ffffff;margin-bottom:10px;">üéØ Aktive √úberwachungsbereiche</h3></div><div class="tracking-section" id="trackingSection"><h3 style="color:#ffffff;margin-bottom:15px;">üìà Aktive Trackings</h3><div id="trackingList"></div></div><div class="log-container"><h3>üìä √Ñnderungs-Log</h3><p style="color:#7289DA;font-size:12px;margin-bottom:10px;">Debug-Infos in der Browser-Konsole (F12)</p><div id="logEntries"></div></div></div><footer class="footer">Made with ‚ù§Ô∏è by Martin Pfeffer</footer><script>const _0x1a2b3c=['stream','video','canvas','ctx','monitoring','intervalId','monitorAreas','currentScanMode','hoveredAreaId','activeTrackings','trackingIdCounter'];const _0x4d5e6f=function(a,b){return a+b;};const _0x7g8h9i=function(x){return x*2;};const _0xjklmno=function(arr){return arr.reverse();};class PixelMonitor{constructor(){this[_0x1a2b3c[0]]=null;this[_0x1a2b3c[1]]=null;this[_0x1a2b3c[2]]=document['getElementById']('preview');this[_0x1a2b3c[3]]=this[_0x1a2b3c[2]]['getContext']('2d',{willReadFrequently:true,alpha:false});this[_0x1a2b3c[4]]=false;this[_0x1a2b3c[5]]=null;this[_0x1a2b3c[6]]=new Map();this[_0x1a2b3c[7]]='auto';this[_0x1a2b3c[8]]=null;this[_0x1a2b3c[9]]=new Map();this[_0x1a2b3c[10]]=0;this['initializeElements']();this['attachEventListeners']();}initializeElements(){this['startBtn']=document['getElementById']('startBtn');this['stopBtn']=document['getElementById']('stopBtn');this['scanModeSelect']=document['getElementById']('scanMode');this['xInput']=document['getElementById']('xPos');this['yInput']=document['getElementById']('yPos');this['intervalInput']=document['getElementById']('interval');this['thresholdInput']=document['getElementById']('threshold');this['sensitivitySelect']=document['getElementById']('sensitivity');this['logEntries']=document['getElementById']('logEntries');this['placeholder']=document['getElementById']('placeholder');this['activeAreas']=document['getElementById']('activeAreas');this['manualControls']=document['getElementById']('manualControls');this['manualControls2']=document['getElementById']('manualControls2');this['trackingSection']=document['getElementById']('trackingSection');this['trackingList']=document['getElementById']('trackingList');}attachEventListeners(){this['startBtn']['addEventListener']('click',()=>this['startMonitoring']());this['stopBtn']['addEventListener']('click',()=>this['stopMonitoring']());this['scanModeSelect']['addEventListener']('change',()=>{this[_0x1a2b3c[7]]=this['scanModeSelect']['value'];this['updateManualControls']();if(this[_0x1a2b3c[4]]){this['setupMonitoringAreas']();}});this[_0x1a2b3c[2]]['addEventListener']('click',(e)=>{if(!this[_0x1a2b3c[4]]||this[_0x1a2b3c[7]]!=='manual')return;const rect=this[_0x1a2b3c[2]]['getBoundingClientRect']();const scaleX=this[_0x1a2b3c[2]]['width']/rect['width'];const scaleY=this[_0x1a2b3c[2]]['height']/rect['height'];const x=Math['floor']((e['clientX']-rect['left'])*scaleX);const y=Math['floor']((e['clientY']-rect['top'])*scaleY);this['xInput']['value']=x;this['yInput']['value']=y;this['setupMonitoringAreas']();this['logEntry'](`Position ge√§ndert: (${x}, ${y})`,false);});}updateManualControls(){const isManual=this[_0x1a2b3c[7]]==='manual';this['manualControls']['style']['display']=isManual?'flex':'none';this['manualControls2']['style']['display']=isManual?'flex':'none';}async startMonitoring(){try{console['log']('Starte Screen Capture...');this[_0x1a2b3c[0]]=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:false});console['log']('Stream erhalten:',this[_0x1a2b3c[0]]);console['log']('Video Tracks:',this[_0x1a2b3c[0]].getVideoTracks());const track=this[_0x1a2b3c[0]].getVideoTracks()[0];if(track){const settings=track.getSettings();console['log']('Track Settings:',settings);}this[_0x1a2b3c[1]]=document.createElement('video');this[_0x1a2b3c[1]].style.display='none';document.body.appendChild(this[_0x1a2b3c[1]]);this[_0x1a2b3c[1]].srcObject=this[_0x1a2b3c[0]];this[_0x1a2b3c[1]].muted=true;this[_0x1a2b3c[1]].playsInline=true;await new Promise(resolve=>setTimeout(resolve,100));this[_0x1a2b3c[1]].play().then(()=>{console['log']('Video l√§uft!');console['log']('Video muted:',this[_0x1a2b3c[1]].muted);}).catch(err=>{console.error('Video-Fehler:',err);this.startBtn.click();});let canvasSetup=false;const setupCanvas=()=>{if(canvasSetup)return;console['log']('Video bereit - Setup Canvas');console['log'](`Video Dimensionen: ${this[_0x1a2b3c[1]].videoWidth}x${this[_0x1a2b3c[1]].videoHeight}`);if(this[_0x1a2b3c[1]].videoWidth===0||this[_0x1a2b3c[1]].videoHeight===0){console.error('Video hat keine g√ºltigen Dimensionen!');setTimeout(setupCanvas,100);return;}console['log']('Video readyState:',this[_0x1a2b3c[1]].readyState);console['log']('Video paused:',this[_0x1a2b3c[1]].paused);console['log']('Video currentTime:',this[_0x1a2b3c[1]].currentTime);canvasSetup=true;this[_0x1a2b3c[2]].width=this[_0x1a2b3c[1]].videoWidth;this[_0x1a2b3c[2]].height=this[_0x1a2b3c[1]].videoHeight;this[_0x1a2b3c[2]].style.display='block';this['placeholder'].style.display='none';this['activeAreas'].style.display='grid';document.getElementById('liveIndicator').style.display='inline-block';console['log'](`Canvas-Gr√∂√üe: ${this[_0x1a2b3c[2]].width}x${this[_0x1a2b3c[2]].height}`);this['logEntry'](`Bildschirm: ${this[_0x1a2b3c[2]].width}x${this[_0x1a2b3c[2]].height}px`,false);this[_0x1a2b3c[4]]=true;this['startBtn'].disabled=true;this['stopBtn'].disabled=false;this['logEntry']('Monitoring gestartet',false);console['log']('Monitoring gestartet - √úberwache Pixel-√Ñnderungen...');this[_0x1a2b3c[3]].drawImage(this[_0x1a2b3c[1]],0,0);this['startFrameUpdate']();setTimeout(()=>{console['log']('Test-Draw nach 500ms');try{this[_0x1a2b3c[3]].drawImage(this[_0x1a2b3c[1]],0,0);const testData=this[_0x1a2b3c[3]].getImageData(100,100,1,1).data;console['log']('Test-Pixel:',testData);console['log']('Canvas ist NICHT tainted - Pixel-Lesen funktioniert!');}catch(err){if(err.name==='SecurityError'){console.error('SICHERHEITSFEHLER: Canvas ist "tainted" - kann keine Pixel lesen!');console.error('M√∂gliche Ursache: Cross-Origin Content oder Tab-Sharing statt Screen-Sharing');}else{console.error('Anderer Fehler:',err);}}},500);this['setupMonitoringAreas']();this[_0x1a2b3c[5]]=setInterval(()=>this['monitorAllAreas'](),parseInt(this['intervalInput'].value));};this[_0x1a2b3c[1]].addEventListener('loadedmetadata',setupCanvas);this[_0x1a2b3c[1]].addEventListener('loadeddata',setupCanvas);setTimeout(()=>{if(!this[_0x1a2b3c[4]]){console['log']('Fallback: Versuche Canvas-Setup direkt');setupCanvas();}},1000);this[_0x1a2b3c[0]].getVideoTracks()[0].addEventListener('ended',()=>{this['stopMonitoring']();});}catch(error){console.error('Fehler beim Starten:',error);alert('Bildschirmfreigabe wurde abgelehnt oder ist nicht verf√ºgbar.');}}startFrameUpdate(){if(!this[_0x1a2b3c[4]]||!this[_0x1a2b3c[1]])return;const updateLoop=()=>{if(!this[_0x1a2b3c[4]]||!this[_0x1a2b3c[1]])return;try{this[_0x1a2b3c[3]].drawImage(this[_0x1a2b3c[1]],0,0);this['drawAllCrosshairs']();}catch(err){console.error('Frame-Update Fehler:',err);}requestAnimationFrame(updateLoop);};requestAnimationFrame(updateLoop);}stopMonitoring(){this[_0x1a2b3c[4]]=false;if(this[_0x1a2b3c[5]]){clearInterval(this[_0x1a2b3c[5]]);this[_0x1a2b3c[5]]=null;}if(this[_0x1a2b3c[0]]){this[_0x1a2b3c[0]].getTracks().forEach(track=>track.stop());this[_0x1a2b3c[0]]=null;}if(this[_0x1a2b3c[1]]){this[_0x1a2b3c[1]].pause();if(this[_0x1a2b3c[1]].parentNode){this[_0x1a2b3c[1]].parentNode.removeChild(this[_0x1a2b3c[1]]);}this[_0x1a2b3c[1]]=null;}this[_0x1a2b3c[2]].style.display='none';this['placeholder'].style.display='block';this['activeAreas'].style.display='none';document.getElementById('liveIndicator').style.display='none';this['startBtn'].disabled=false;this['stopBtn'].disabled=true;this['logEntry']('Monitoring gestoppt',false);}setupMonitoringAreas(){this[_0x1a2b3c[6]].clear();this['activeAreas'].innerHTML='<h3 style="grid-column: 1 / -1; color: #ffffff; margin-bottom: 10px;">üéØ Aktive √úberwachungsbereiche</h3>';if(!this[_0x1a2b3c[2]].width||!this[_0x1a2b3c[2]].height)return;let areas=[];switch(this[_0x1a2b3c[7]]){case'auto':const gridSize=12;for(let i=1;i<gridSize-1;i++){for(let j=1;j<gridSize-1;j++){const x=Math['floor']((i/(gridSize-1))*this[_0x1a2b3c[2]]['width']);const y=Math['floor']((j/(gridSize-1))*this[_0x1a2b3c[2]]['height']);areas['push']({x,y,id:`auto_${i}_${j}`});}}break;case'grid':for(let i=0;i<9;i++){for(let j=0;j<9;j++){const x=Math['floor']((i/8)*this[_0x1a2b3c[2]]['width']);const y=Math['floor']((j/8)*this[_0x1a2b3c[2]]['height']);areas['push']({x,y,id:`grid_${i}_${j}`});}}break;case'center':const centerX=Math['floor'](this[_0x1a2b3c[2]]['width']/2);const centerY=Math['floor'](this[_0x1a2b3c[2]]['height']/2);areas['push']({x:centerX,y:centerY,id:'center'});break;case'manual':const x=Math['max'](0,Math['min'](parseInt(this['xInput']['value']),this[_0x1a2b3c[2]]['width']-1));const y=Math['max'](0,Math['min'](parseInt(this['yInput']['value']),this[_0x1a2b3c[2]]['height']-1));areas['push']({x,y,id:'manual'});break;}areas.forEach(area=>{this[_0x1a2b3c[6]].set(area.id,{x:area.x,y:area.y,lastColor:null,element:this.createAreaElement(area)});});console['log'](`${areas['length']} Bereiche f√ºr ${this[_0x1a2b3c[7]]}-Modus erstellt`);this['logEntry'](`${areas['length']} Bereiche werden √ºberwacht (${this[_0x1a2b3c[7]]})`,false);}createAreaElement(area){const card=document.createElement('div');card.className='area-card';card.dataset.areaId=area.id;card.innerHTML=`<div class="area-info"><div class="area-color" id="color_${area.id}"></div><div class="area-pos">(${area.x}, ${area.y})</div></div><div class="area-change" id="change_${area.id}">Warte auf Daten...</div>`;card.addEventListener('mouseenter',()=>{this[_0x1a2b3c[8]]=area.id;card.style.transform='scale(1.05)';card.style.zIndex='10';});card.addEventListener('mouseleave',()=>{this[_0x1a2b3c[8]]=null;card.style.transform='scale(1)';card.style.zIndex='1';});card.addEventListener('click',()=>{this.showTrackingDialog(area);});this['activeAreas'].appendChild(card);return card;}monitorAllAreas(){if(!this[_0x1a2b3c[4]]||!this[_0x1a2b3c[1]]||this[_0x1a2b3c[6]].size===0)return;const threshold=this.getThresholdValue();let activeChanges=0;this[_0x1a2b3c[6]].forEach((area,id)=>{try{const imageData=this[_0x1a2b3c[3]].getImageData(area.x,area.y,1,1);const[r,g,b]=imageData.data;const colorElement=document.getElementById(`color_${id}`);const changeElement=document.getElementById(`change_${id}`);if(colorElement){colorElement.style.backgroundColor=`rgb(${r}, ${g}, ${b})`;}if(area.lastColor){const diffR=Math.abs(r-area.lastColor.r);const diffG=Math.abs(g-area.lastColor.g);const diffB=Math.abs(b-area.lastColor.b);const totalDiff=diffR+diffG+diffB;if(totalDiff>threshold){activeChanges++;area.element.classList.add('active');if(changeElement){changeElement.textContent=`Œî${totalDiff} RGB(${r},${g},${b})`;}this['logEntry'](`Bereich (${area.x},${area.y}): RGB(${r},${g},${b}) - Diff: ${totalDiff}`,true);setTimeout(()=>{area.element.classList.remove('active');},2000);}else if(changeElement){changeElement.textContent=`RGB(${r},${g},${b})`;}}else if(changeElement){changeElement.textContent=`RGB(${r},${g},${b})`;}area.lastColor={r,g,b};}catch(error){console.error(`Fehler beim Lesen von Bereich ${id}:`,error);}});}getThresholdValue(){const sensitivity=this['sensitivitySelect'].value;const baseThreshold=parseInt(this['thresholdInput'].value);switch(sensitivity){case'low':return baseThreshold*3;case'high':return Math.max(1,Math.floor(baseThreshold/2));default:return baseThreshold;}}drawAllCrosshairs(){if(!this[_0x1a2b3c[4]]||this[_0x1a2b3c[6]].size===0)return;this[_0x1a2b3c[6]].forEach((area,id)=>{const isActive=area.element.classList.contains('active');const isHovered=this[_0x1a2b3c[8]]===id;this.drawCrosshair(area.x,area.y,isActive,isHovered);});}rgbToHex(r,g,b){return'#'+[r,g,b].map(x=>{const hex=x.toString(16);return hex.length===1?'0'+hex:hex;}).join('').toUpperCase();}drawCrosshair(x,y,isActive=false,isHovered=false){this[_0x1a2b3c[3]].save();let color,size,lineWidth,alpha;if(isHovered){color='#FF4444';size=12;lineWidth=4;alpha=1.0;}else if(isActive){color='#F0B232';size=8;lineWidth=3;alpha=1.0;}else{color='#7289DA';size=4;lineWidth=1;alpha=0.6;}this[_0x1a2b3c[3]].strokeStyle=color;this[_0x1a2b3c[3]].fillStyle=color;this[_0x1a2b3c[3]].lineWidth=lineWidth;this[_0x1a2b3c[3]].globalAlpha=alpha;this[_0x1a2b3c[3]].beginPath();this[_0x1a2b3c[3]].arc(x,y,size,0,2*Math.PI);this[_0x1a2b3c[3]].stroke();this[_0x1a2b3c[3]].beginPath();this[_0x1a2b3c[3]].arc(x,y,size/2,0,2*Math.PI);this[_0x1a2b3c[3]].fill();this[_0x1a2b3c[3]].globalAlpha=1.0;this[_0x1a2b3c[3]].fillStyle='#FFFFFF';this[_0x1a2b3c[3]].beginPath();this[_0x1a2b3c[3]].arc(x,y,1,0,2*Math.PI);this[_0x1a2b3c[3]].fill();this[_0x1a2b3c[3]].restore();}updateCrosshair(e){const rect=this[_0x1a2b3c[2]].getBoundingClientRect();const scaleX=this[_0x1a2b3c[2]].width/rect.width;const scaleY=this[_0x1a2b3c[2]].height/rect.height;const x=(e.clientX-rect.left)*scaleX;const y=(e.clientY-rect.top)*scaleY;this[_0x1a2b3c[2]].style.cursor='crosshair';}logEntry(message,isChange=false){const entry=document.createElement('div');entry.className=`log-entry ${isChange?'change':''}`;const timestamp=new Date().toLocaleTimeString('de-DE');entry.innerHTML=`<span>${message}</span><span class="timestamp">${timestamp}</span>`;this['logEntries'].insertBefore(entry,this['logEntries'].firstChild);while(this['logEntries'].children.length>50){this['logEntries'].removeChild(this['logEntries'].lastChild);}}showTrackingDialog(area){const dialogHtml=`<div class="dialog-overlay" id="trackingDialog"><div class="dialog"><h2>üìä Tracking f√ºr Bereich (${area.x}, ${area.y}) erstellen</h2><div class="dialog-form"><div class="input-group"><label for="trackingTitle">Titel</label><input type="text" id="trackingTitle" placeholder="z.B. Button-Zustand, Ladebalken..." value="Bereich ${area.x},${area.y}"></div><div class="input-group"><label for="trackingInterval">Aufzeichnungsintervall (Sekunden)</label><input type="number" id="trackingInterval" value="5" min="1" max="3600" step="1"></div><div class="input-group"><label for="trackingDuration">Maximale Aufzeichnungsdauer (Minuten, 0 = unbegrenzt)</label><input type="number" id="trackingDuration" value="30" min="0" max="1440" step="1"></div></div><div class="dialog-buttons"><button class="btn-cancel" onclick="monitor.closeTrackingDialog()">Abbrechen</button><button class="btn-track" onclick="monitor.createTracking('${area.id}', ${area.x}, ${area.y})">Tracking starten</button></div></div></div>`;document.body.insertAdjacentHTML('beforeend',dialogHtml);document.addEventListener('keydown',this.handleDialogEscape.bind(this));}handleDialogEscape(e){if(e.key==='Escape'){this.closeTrackingDialog();}}closeTrackingDialog(){const dialog=document.getElementById('trackingDialog');if(dialog){dialog.remove();document.removeEventListener('keydown',this.handleDialogEscape);}}createTracking(areaId,x,y){const title=document.getElementById('trackingTitle').value.trim();const interval=parseInt(document.getElementById('trackingInterval').value)*1000;const duration=parseInt(document.getElementById('trackingDuration').value)*60*1000;if(!title){alert('Bitte geben Sie einen Titel ein!');return;}const trackingId=`tracking_${++this[_0x1a2b3c[10]]}`;const tracking={id:trackingId,title:title,x:x,y:y,areaId:areaId,interval:interval,duration:duration,startTime:Date.now(),endTime:duration>0?Date.now()+duration:null,active:true,history:[],lastColor:null,intervalHandle:null};this.startTracking(tracking);this[_0x1a2b3c[9]].set(trackingId,tracking);this.updateTrackingUI();this['trackingSection'].style.display='block';this.closeTrackingDialog();this['logEntry'](`Tracking "${title}" gestartet`,false);}startTracking(tracking){tracking.intervalHandle=setInterval(()=>{if(!this[_0x1a2b3c[4]]||!tracking.active)return;if(tracking.endTime&&Date.now()>tracking.endTime){this.stopTracking(tracking.id);return;}try{const imageData=this[_0x1a2b3c[3]].getImageData(tracking.x,tracking.y,1,1);const[r,g,b]=imageData.data;const currentColor={r,g,b};let hasChanged=false;if(tracking.lastColor){const threshold=this.getThresholdValue();const diffR=Math.abs(r-tracking.lastColor.r);const diffG=Math.abs(g-tracking.lastColor.g);const diffB=Math.abs(b-tracking.lastColor.b);const totalDiff=diffR+diffG+diffB;hasChanged=totalDiff>threshold;}const entry={timestamp:Date.now(),color:currentColor,changed:hasChanged,diff:tracking.lastColor?Math.abs(r-tracking.lastColor.r)+Math.abs(g-tracking.lastColor.g)+Math.abs(b-tracking.lastColor.b):0};tracking.history.push(entry);tracking.lastColor=currentColor;if(tracking.history.length>1000){tracking.history.shift();}this.updateTrackingHistoryUI(tracking.id);}catch(error){console.error(`Tracking-Fehler f√ºr ${tracking.title}:`,error);}},tracking.interval);}stopTracking(trackingId){const tracking=this[_0x1a2b3c[9]].get(trackingId);if(!tracking)return;tracking.active=false;if(tracking.intervalHandle){clearInterval(tracking.intervalHandle);tracking.intervalHandle=null;}this.updateTrackingUI();this['logEntry'](`Tracking "${tracking.title}" gestoppt`,false);}updateTrackingUI(){this['trackingList'].innerHTML='';this[_0x1a2b3c[9]].forEach((tracking,id)=>{const trackingElement=this.createTrackingElement(tracking);this['trackingList'].appendChild(trackingElement);});if(this[_0x1a2b3c[9]].size===0){this['trackingSection'].style.display='none';}}createTrackingElement(tracking){const div=document.createElement('div');div.className='tracking-item';div.innerHTML=`<div class="tracking-header"><div class="tracking-title">${tracking.title}</div><div class="tracking-status ${tracking.active?'active':'inactive'}">${tracking.active?'AKTIV':'GESTOPPT'}</div></div><div class="tracking-info">Position: (${tracking.x}, ${tracking.y}) | Intervall: ${tracking.interval/1000}s | Eintr√§ge: ${tracking.history.length} |Gestartet: ${new Date(tracking.startTime).toLocaleTimeString('de-DE')}</div><div class="tracking-history" id="history_${tracking.id}"></div><div class="tracking-controls">${tracking.active?`<button class="btn-stop" onclick="monitor.stopTracking('${tracking.id}')">Stoppen</button>`:`<button class="btn-start" onclick="monitor.resumeTracking('${tracking.id}')">Fortsetzen</button>`}<button class="btn-cancel" onclick="monitor.deleteTracking('${tracking.id}')">L√∂schen</button><button class="btn-track" onclick="monitor.exportTracking('${tracking.id}')">Exportieren</button></div>`;return div;}updateTrackingHistoryUI(trackingId){const tracking=this[_0x1a2b3c[9]].get(trackingId);if(!tracking)return;const historyContainer=document.getElementById(`history_${trackingId}`);if(!historyContainer)return;const recentEntries=tracking.history.slice(-20);historyContainer.innerHTML=recentEntries.map(entry=>{const time=new Date(entry.timestamp).toLocaleTimeString('de-DE');const colorStr=`RGB(${entry.color.r},${entry.color.g},${entry.color.b})`;const status=entry.changed?'GE√ÑNDERT':'UNVER√ÑNDERT';return`<div class="history-entry ${entry.changed?'changed':'unchanged'}"><span>${time} - ${status}</span><span>${colorStr} ${entry.changed?`(Œî${entry.diff})`:''}</span></div>`;}).join('');historyContainer.scrollTop=historyContainer.scrollHeight;}resumeTracking(trackingId){const tracking=this[_0x1a2b3c[9]].get(trackingId);if(!tracking)return;tracking.active=true;this.startTracking(tracking);this.updateTrackingUI();this['logEntry'](`Tracking "${tracking.title}" fortgesetzt`,false);}deleteTracking(trackingId){if(!confirm('Tracking wirklich l√∂schen? Die Historie geht verloren.'))return;const tracking=this[_0x1a2b3c[9]].get(trackingId);if(tracking&&tracking.intervalHandle){clearInterval(tracking.intervalHandle);}this[_0x1a2b3c[9]].delete(trackingId);this.updateTrackingUI();if(tracking){this['logEntry'](`Tracking "${tracking.title}" gel√∂scht`,false);}}exportTracking(trackingId){const tracking=this[_0x1a2b3c[9]].get(trackingId);if(!tracking)return;const data={title:tracking.title,position:{x:tracking.x,y:tracking.y},startTime:tracking.startTime,endTime:tracking.endTime,interval:tracking.interval,totalEntries:tracking.history.length,changedEntries:tracking.history.filter(e=>e.changed).length,history:tracking.history.map(entry=>({timestamp:entry.timestamp,time:new Date(entry.timestamp).toISOString(),color:entry.color,changed:entry.changed,diff:entry.diff}))};const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=`tracking_${tracking.title.replace(/[^a-zA-Z0-9]/g,'_')}_${new Date().toISOString().split('T')[0]}.json`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);this['logEntry'](`Tracking "${tracking.title}" exportiert`,false);}}const monitor=new PixelMonitor();window.monitor=monitor;window.testDraw=function(){if(monitor[_0x1a2b3c[1]]&&monitor[_0x1a2b3c[3]]){console['log']('Manueller Frame-Draw Test...');try{monitor[_0x1a2b3c[3]].drawImage(monitor[_0x1a2b3c[1]],0,0);const testPixel=monitor[_0x1a2b3c[3]].getImageData(100,100,1,1).data;console['log']('Test-Pixel nach manuellem Draw:',testPixel);monitor[_0x1a2b3c[3]].fillStyle='green';monitor[_0x1a2b3c[3]].fillRect(100,100,20,20);console['log']('Gr√ºnes Rechteck bei (100,100) gezeichnet');}catch(err){console.error('Fehler beim Test-Draw:',err);}}else{console['log']('Video oder Canvas nicht bereit');}};window.scanPixels=function(){if(!monitor[_0x1a2b3c[4]]||!monitor[_0x1a2b3c[3]]){console['log']('Monitor muss aktiv sein!');return;}const centerX=parseInt(monitor['xInput'].value);const centerY=parseInt(monitor['yInput'].value);console['log']('=== PIXEL SCAN 5x5 um Position ('+centerX+','+centerY+') ===');for(let dy=-2;dy<=2;dy++){let row='';for(let dx=-2;dx<=2;dx++){const x=centerX+dx*20;const y=centerY+dy*20;try{const pixel=monitor[_0x1a2b3c[3]].getImageData(x,y,1,1).data;const color=`${pixel[0]},${pixel[1]},${pixel[2]}`;row+=`(${x},${y}): RGB(${color}) | `;}catch(e){row+=`(${x},${y}): ERROR | `;}}console['log'](row);}console['log']('=== SCAN ENDE ===');monitor['logEntry']('Pixel-Scan durchgef√ºhrt (siehe Konsole)',false);};window.findActiveArea=function(){if(!monitor[_0x1a2b3c[4]]||!monitor[_0x1a2b3c[3]]||!monitor[_0x1a2b3c[1]]){console['log']('Monitor muss aktiv sein!');return;}console['log']('Suche nach aktivem Bereich...');monitor['logEntry']('Suche aktiven Bereich...',false);const width=monitor[_0x1a2b3c[2]].width;const height=monitor[_0x1a2b3c[2]].height;const samples=10;let maxDiff=0;let bestX=width/2;let bestY=height/2;const frame1Data=monitor[_0x1a2b3c[3]].getImageData(0,0,width,height);setTimeout(()=>{monitor[_0x1a2b3c[3]].drawImage(monitor[_0x1a2b3c[1]],0,0);const frame2Data=monitor[_0x1a2b3c[3]].getImageData(0,0,width,height);for(let i=0;i<samples;i++){for(let j=0;j<samples;j++){const x=Math.floor((i+0.5)*width/samples);const y=Math.floor((j+0.5)*height/samples);const idx=(y*width+x)*4;const diff=Math.abs(frame1Data.data[idx]-frame2Data.data[idx])+Math.abs(frame1Data.data[idx+1]-frame2Data.data[idx+1])+Math.abs(frame1Data.data[idx+2]-frame2Data.data[idx+2]);if(diff>maxDiff){maxDiff=diff;bestX=x;bestY=y;}}}if(maxDiff>0){console['log'](`Aktivster Bereich gefunden bei (${bestX}, ${bestY}) mit Differenz: ${maxDiff}`);monitor['xInput'].value=bestX;monitor['yInput'].value=bestY;monitor['logEntry'](`Aktiver Bereich: (${bestX}, ${bestY})`,true);monitor.monitorPixel();}else{console['log']('Kein aktiver Bereich gefunden - Bild scheint statisch zu sein');monitor['logEntry']('Kein aktiver Bereich gefunden',false);}},500);};</script></body></html>