<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Immo Berlin - Übersicht</title>
    <link rel="stylesheet" href="css/dark-theme.css">
    <style>
        /* Zusätzliche spezifische Stile für die Indexseite */
        ul {
            list-style-type: none;
            padding: 0;
        }

        li {
            margin-bottom: var(--spacing-4);
            border-left: 3px solid var(--accent-blue);
            padding-left: var(--spacing-4);
            transition: var(--transition-normal);
        }

        li:hover {
            border-left-color: var(--accent-green);
            transform: translateX(3px);
        }

        a {
            color: var(--text-primary);
            text-decoration: none;
            font-size: 1.125rem;
            display: block;
            padding: var(--spacing-1) 0;
            transition: var(--transition-fast);
        }

        a:hover {
            color: var(--accent-blue);
            text-decoration: none;
        }

        .description {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: var(--spacing-1);
        }

        #update-message {
            background-color: var(--background-darker);
            padding: var(--spacing-3);
            border-radius: var(--radius);
            margin-top: var(--spacing-8);
            font-size: 0.875rem;
            border-left: 3px solid var(--accent-green);
        }

        #loading {
            color: var(--text-secondary);
            margin: var(--spacing-4) 0;
            font-style: italic;
        }

        .update-btn {
            margin-left: var(--spacing-2);
            padding: var(--spacing-1) var(--spacing-3);
            background-color: var(--accent-green);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .update-btn:hover {
            background-color: #8ba680;
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
<h1>Immo Berlin - Übersicht</h1>

<div id="loading">Seiten werden geladen...</div>
<ul id="page-list"></ul>

<div id="update-message">
    Diese Seite aktualisiert sich automatisch, wenn neue HTML-Dateien hinzugefügt werden.
    <button onclick="findHtmlFiles()" class="update-btn">
        Manuell aktualisieren
    </button>
</div>

<script>
    // Bekannte HTML-Dateien als Fallback
    const knownFiles = [
        {
            url: "berlin-bezirke-vergleich.html",
            title: "Berlin Bezirke Vergleich",
            description: "Vergleich der verschiedenen Bezirke in Berlin"
        },
        {
            url: "mieten-berlin-bezirke.html",
            title: "Mieten Berlin Bezirke",
            description: "Informationen zu Mieten in verschiedenen Berliner Bezirken"
        },
        {
            url: "mieten-berlin-potenzial.html",
            title: "Mieten Berlin Potenzial",
            description: "Potenzialanalyse für Mietobjekte in Berlin"
        },
        {
            url: "berlin-bezirke-ranking-investor.html",
            title: "Berliner Bezirke Ranking für Investoren",
            description: "Ranking der Berliner Bezirke aus Investorensicht nach Kaufpreis/Mietertrag und Wertsteigerung"
        },
        {
            url: "berlin-mietvertraege-vergleich.html",
            title: "Feste vs. Befristete Mietverträge in Berlin",
            description: "Gegenüberstellung von unbefristeten und befristeten Mietverträgen für Berliner Vermieter"
        },
        {
            url: "berlin-heatmap-bevoelkerung.html",
            title: "Berlin Heatmap Bevölkerung",
            description: "Visualisierung der Bevölkerungsdichte in Berlin als Heatmap"
        },
        {
            url: "berlin-immobilien-heatmap.html",
            title: "Berlin Immobilien Heatmap",
            description: "Heatmap der Immobilienpreise in Berlin"
        },
        {
            url: "berlin-mietpreise-heatmap.html",
            title: "Berlin Mietpreise Heatmap",
            description: "Visualisierung der Mietpreise in Berlin als Heatmap"
        },
        {
            url: "berlin-kultur-heatmap.html",
            title: "Berlin Kultur Heatmap",
            description: "Visualisierung der kulturellen Angebote in Berlin als Heatmap"
        },
        {
            url: "berlin-soziodata-heatmap.html",
            title: "Berlin Sozio-Data Heatmap",
            description: "Visualisierung weiterer Faktoren in Berlin als Heatmap"
        },
        {
            url: "berlin-gentrifizierung-potenzial.html",
            title: "Berlin Gentrifizierung Potenzial",
            description: "Analyse des Gentrifizierungspotenzials in Berliner Bezirken"
        },
        {
            url: "berlin-rendite-wertsteigerung-vergleich.html",
            title: "Mietrendite vs. Wertsteigerung Berlin",
            description: "Vergleich von Mietrendite und Wertsteigerung bei Immobilieninvestitionen in Berlin"
        }
    ];

    // Formatiert einen Dateinamen in einen lesbaren Titel
    function formatTitle(filename) {
        return filename
            .replace('.html', '')
            .replace(/-/g, ' ')
            .split(' ')
            .map(word => word.charAt(0).toUpperCase() + word.slice(1))
            .join(' ');
    }

    // Generiert eine Beschreibung basierend auf dem Titel
    function generateDescription(title) {
        if (title.includes("Ranking") || title.includes("Ranking")) {
            return "Ranking der Berliner Bezirke aus Investorensicht";
        } else if (title.includes("Bezirke")) {
            return "Informationen zu Berliner Bezirken";
        } else if (title.includes("Mieten")) {
            return "Daten zu Mietpreisen in Berlin";
        } else if (title.includes("Potenzial")) {
            return "Potenzialanalyse für den Berliner Immobilienmarkt";
        } else if (title.includes("Vergleich")) {
            return "Vergleichende Daten zu Berlin";
        } else {
            return "Informationen zum Berliner Immobilienmarkt";
        }
    }

    // Fügt eine Seite zur Liste hinzu
    function addPage(url, title, description) {
        const pageList = document.getElementById('page-list');
        const li = document.createElement('li');

        const a = document.createElement('a');
        a.href = url;
        a.textContent = title || formatTitle(url);

        const desc = document.createElement('div');
        desc.className = 'description';
        desc.textContent = description || generateDescription(title || url);

        li.appendChild(a);
        li.appendChild(desc);
        pageList.appendChild(li);
    }

    // Sucht HTML-Dateien im aktuellen Verzeichnis
    async function findHtmlFiles() {
        const pageList = document.getElementById('page-list');
        const loading = document.getElementById('loading');

        pageList.innerHTML = ''; // Liste leeren
        loading.style.display = 'block';

        // Versuche 1: XMLHttpRequest, um Verzeichnis zu scannen
        function scanDirectoryWithXHR() {
            return new Promise((resolve) => {
                const xhr = new XMLHttpRequest();
                xhr.open('GET', '.', true);
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        const parser = new DOMParser();
                        const htmlDoc = parser.parseFromString(xhr.responseText, 'text/html');
                        const links = htmlDoc.querySelectorAll('a');

                        const htmlFiles = Array.from(links)
                            .map(link => link.getAttribute('href'))
                            .filter(href => href && href.endsWith('.html') && href !== 'index.html');

                        resolve(htmlFiles);
                    } else if (xhr.readyState === 4) {
                        resolve([]);
                    }
                };
                xhr.send();
            });
        }

        // Versuche 2: Fetch API
        async function scanDirectoryWithFetch() {
            try {
                const response = await fetch('.');
                const text = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');
                const links = Array.from(doc.querySelectorAll('a'));

                return links
                    .map(link => link.getAttribute('href'))
                    .filter(href => href && href.endsWith('.html') && href !== 'index.html');
            } catch (e) {
                console.error("Fetch fehlgeschlagen:", e);
                return [];
            }
        }

        try {
            // Versuche beide Methoden
            let htmlFiles = await scanDirectoryWithXHR();

            if (htmlFiles.length === 0) {
                htmlFiles = await scanDirectoryWithFetch();
            }

            // Wenn beide Methoden fehlschlagen, verwende die bekannten Dateien
            if (htmlFiles.length === 0) {
                console.log("Verwende bekannte Dateien als Fallback");
                knownFiles.forEach(file => {
                    addPage(file.url, file.title, file.description);
                });
            } else {
                // Sonst zeige die gefundenen Dateien an
                htmlFiles.forEach(file => {
                    const title = formatTitle(file);
                    const description = generateDescription(title);
                    addPage(file, title, description);
                });
            }
        } catch (error) {
            console.error("Fehler beim Scannen des Verzeichnisses:", error);
            // Fallback zu bekannten Dateien
            knownFiles.forEach(file => {
                addPage(file.url, file.title, file.description);
            });
        }

        loading.style.display = 'none';
    }

    // Starte den Scan beim Laden der Seite
    document.addEventListener('DOMContentLoaded', findHtmlFiles);
</script>
</body>
</html>