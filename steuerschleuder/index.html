<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brutto-Netto-Rechner</title>
    <style>
        :root {
            --primary-color: #2C2E3B;
            --primary-light: #383B4F;
            --text-color: #ffffff;
            --text-secondary: #e5e7eb;
            --text-muted: #9ca3af;
            --background-color: #2C2E3B;
            --card-color: #383B4F;
            --blue-300: #93c5fd;
            --blue-600: #2563eb;
            --blue-700: #1d4ed8;
            --border-radius: 8px;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --padding: 24px;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            touch-action: manipulation;
        }
        
        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 16px 16px 64px;
            min-height: 100vh;
            transition: colors 300ms;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: contain;
        }
        
        .container {
            max-width: 1024px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }
        
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
        
        .header {
            grid-column: 1 / -1;
            background-color: var(--card-color);
            color: var(--text-color);
            padding: var(--padding);
            border-radius: var(--border-radius);
            margin-bottom: 24px;
            box-shadow: var(--shadow);
            animation: fadeIn 0.3s ease-in-out;
        }
        
        .card {
            background-color: var(--card-color);
            padding: var(--padding);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            animation: slideIn 0.4s ease-out;
        }
        
        h1 {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 16px;
            color: var(--blue-300);
            line-height: 1.2;
        }
        
        h2, h3 {
            margin-bottom: 16px;
            color: var(--blue-300);
            font-weight: 600;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-secondary);
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #4b5563;
            background-color: var(--primary-color);
            color: var(--text-color);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--blue-600);
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2);
        }
        
        button {
            background-color: var(--blue-600);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 9999px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            margin-top: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        button:hover {
            background-color: var(--blue-700);
            transform: scale(1.02);
        }
        
        .result-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #4b5563;
            transition: background-color 0.2s;
        }
        
        .result-row:last-child {
            border-bottom: none;
        }
        
        .result-label {
            font-weight: 500;
            color: var(--text-secondary);
        }
        
        .result-value {
            font-weight: 700;
            color: var(--blue-300);
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 24px;
            cursor: pointer;
            background-color: var(--primary-color);
            color: var(--text-secondary);
            border-radius: 8px 8px 0 0;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .tab:hover {
            background-color: #4b5563;
            transform: scale(1.02);
        }
        
        .tab.active {
            background-color: var(--blue-600);
            color: white;
            font-weight: 600;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .summary-card {
            margin-top: 24px;
            background-color: var(--primary-color);
            border: 1px solid var(--blue-600);
            animation: slideIn 0.5s ease-out;
        }
        
        .chart-container {
            height: 300px;
            margin-top: 20px;
        }
        
        /* PWA Animationen und Transitions */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from { transform: translateY(10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes chartLoad {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        .animate-slideIn {
            animation: slideIn 0.4s ease-out;
        }
        
        .animate-chartLoad {
            animation: chartLoad 0.5s ease-out;
        }
        
        /* Besseres Touch-Feedback f√ºr mobile Ger√§te */
        button, a {
            -webkit-tap-highlight-color: transparent;
        }
        
        /* Footer */
        .footer {
            margin-top: 32px;
            padding-top: 16px;
            padding-bottom: 8px;
            text-align: center;
            color: var(--text-muted);
            grid-column: 1 / -1;
        }
        
        @media (max-width: 640px) {
            /* Optimierung f√ºr kleine Bildschirme */
            input, button {
                font-size: 16px; /* Verhindert Zoom auf iOS bei Focus */
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ Brutto-Netto-Rechner f√ºr Deutschland 2025</h1>
            <p style="color: var(--text-secondary);">Berechne Dein Nettogehalt und Abgaben nach den aktuellen Steuers√§tzen 2025</p>
        </div>
        
        <div class="card">
            <div class="tabs">
                <div class="tab active" data-tab="monthly">Monatsgehalt</div>
                <div class="tab" data-tab="yearly">Jahresgehalt</div>
            </div>
            
            <div class="tab-content active" id="monthly-tab">
                <div class="form-group">
                    <label for="monthly-salary">Bruttogehalt pro Monat (‚Ç¨)</label>
                    <input type="number" id="monthly-salary" min="0" step="100" value="3000">
                </div>
            </div>
            
            <div class="tab-content" id="yearly-tab">
                <div class="form-group">
                    <label for="yearly-salary">Bruttogehalt pro Jahr (‚Ç¨)</label>
                    <input type="number" id="yearly-salary" min="0" step="1000" value="36000">
                </div>
            </div>
            
            <div class="form-group">
                <label for="tax-class">Steuerklasse</label>
                <select id="tax-class">
                    <option value="1">Steuerklasse I (Ledig)</option>
                    <option value="2">Steuerklasse II (Alleinerziehend)</option>
                    <option value="3">Steuerklasse III (Verheiratet, Alleinverdiener)</option>
                    <option value="4">Steuerklasse IV (Verheiratet, beide verdienen)</option>
                    <option value="5">Steuerklasse V (Verheiratet, weniger verdienend)</option>
                    <option value="6">Steuerklasse VI (Nebenjob)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="state">Bundesland</label>
                <select id="state">
                    <option value="bw">Baden-W√ºrttemberg</option>
                    <option value="by">Bayern</option>
                    <option value="be">Berlin</option>
                    <option value="bb">Brandenburg</option>
                    <option value="hb">Bremen</option>
                    <option value="hh">Hamburg</option>
                    <option value="he">Hessen</option>
                    <option value="mv">Mecklenburg-Vorpommern</option>
                    <option value="ni">Niedersachsen</option>
                    <option value="nw">Nordrhein-Westfalen</option>
                    <option value="rp">Rheinland-Pfalz</option>
                    <option value="sl">Saarland</option>
                    <option value="sn">Sachsen</option>
                    <option value="st">Sachsen-Anhalt</option>
                    <option value="sh">Schleswig-Holstein</option>
                    <option value="th">Th√ºringen</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="children">Anzahl Kinder</label>
                <input type="number" id="children" min="0" max="10" value="0">
            </div>
            
            <div class="form-group">
                <label for="church-tax">Kirchensteuer</label>
                <select id="church-tax">
                    <option value="0">Keine Kirchensteuer</option>
                    <option value="1">Kirchensteuer</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="health-insurance">Krankenversicherungssatz (%)</label>
                <input type="number" id="health-insurance" min="14" max="16" step="0.1" value="14.6">
            </div>
            
            <div class="form-group">
                <label for="additional-health">Zusatzbeitrag Krankenkasse (%)</label>
                <input type="number" id="additional-health" min="0" max="4" step="0.1" value="2.5">
            </div>
            
            <button id="calculate-btn">Berechnen</button>
        </div>
        
        <div class="card">
            <h2>Ergebnisse</h2>
            
            <div id="monthly-results">
                <h3>Monatlich</h3>
                <div class="result-row">
                    <span class="result-label">Bruttogehalt:</span>
                    <span class="result-value" id="monthly-gross">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Lohnsteuer:</span>
                    <span class="result-value" id="monthly-income-tax">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Solidarit√§tszuschlag:</span>
                    <span class="result-value" id="monthly-solidarity">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Kirchensteuer:</span>
                    <span class="result-value" id="monthly-church">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Krankenversicherung:</span>
                    <span class="result-value" id="monthly-health">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Pflegeversicherung:</span>
                    <span class="result-value" id="monthly-care">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Rentenversicherung:</span>
                    <span class="result-value" id="monthly-pension">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Arbeitslosenversicherung:</span>
                    <span class="result-value" id="monthly-unemployment">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Gesamtabgaben:</span>
                    <span class="result-value" id="monthly-total-deductions">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Nettogehalt:</span>
                    <span class="result-value" id="monthly-net">0,00 ‚Ç¨</span>
                </div>
            </div>
            
            <div id="yearly-results">
                <h3>J√§hrlich</h3>
                <div class="result-row">
                    <span class="result-label">Bruttogehalt:</span>
                    <span class="result-value" id="yearly-gross">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Lohnsteuer:</span>
                    <span class="result-value" id="yearly-income-tax">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Solidarit√§tszuschlag:</span>
                    <span class="result-value" id="yearly-solidarity">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Kirchensteuer:</span>
                    <span class="result-value" id="yearly-church">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Krankenversicherung:</span>
                    <span class="result-value" id="yearly-health">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Pflegeversicherung:</span>
                    <span class="result-value" id="yearly-care">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Rentenversicherung:</span>
                    <span class="result-value" id="yearly-pension">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Arbeitslosenversicherung:</span>
                    <span class="result-value" id="yearly-unemployment">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Gesamtabgaben:</span>
                    <span class="result-value" id="yearly-total-deductions">0,00 ‚Ç¨</span>
                </div>
                <div class="result-row">
                    <span class="result-label">Nettogehalt:</span>
                    <span class="result-value" id="yearly-net">0,00 ‚Ç¨</span>
                </div>
            </div>
            
            <div class="card summary-card">
                <div class="result-row">
                    <span class="result-label">Abgabenquote:</span>
                    <span class="result-value" id="deduction-rate">0,00 %</span>
                </div>
            </div>
        </div>
        
        <!-- Footer - matching weather app -->
        <div class="footer">
            Made with ‚ù§Ô∏è by Martin Pfeffer
        </div>
    </div>
    
    <script>
        // Tabwechsel Funktionalit√§t
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                
                tab.classList.add('active');
                document.getElementById(`${tabId}-tab`).classList.add('active');
                
                // Bei Tabwechsel Werte synchronisieren
                if (tabId === 'monthly') {
                    const yearlyValue = parseFloat(document.getElementById('yearly-salary').value);
                    document.getElementById('monthly-salary').value = Math.round(yearlyValue / 12);
                } else {
                    const monthlyValue = parseFloat(document.getElementById('monthly-salary').value);
                    document.getElementById('yearly-salary').value = Math.round(monthlyValue * 12);
                }
            });
        });
        
        // Steuers√§tze und Konstanten f√ºr 2025
        const taxConstants = {
            // Einkommensteuer 2025
            basicAllowance: 12096, // Grundfreibetrag
            taxZone2Start: 12097,
            taxZone2End: 17430,
            taxZone3Start: 17431,
            taxZone3End: 68480,
            taxZone4Start: 68481,
            taxZone4End: 277825,
            taxZone5Start: 277826,
            
            // Kinderfreibetrag 2025 (pro Kind)
            childAllowance: 6672, // Erh√∂hung f√ºr 2025
            
            // Sozialversicherungsbeitr√§ge 2025 (Arbeitnehmeranteil)
            pensionRate: 18.6 / 100, // Rentenversicherung (9,3% Arbeitnehmeranteil)
            unemploymentRate: 2.6 / 100, // Arbeitslosenversicherung (1,3% Arbeitnehmeranteil)
            healthRate: 14.6 / 100, // Krankenversicherung Grundbeitrag (7,3% Arbeitnehmeranteil)
            additionalHealthRate: 5.0 / 100, // Zusatzbeitrag durchschnittlich (2,5% Arbeitnehmeranteil)
            careRate: 3.6 / 100, // Pflegeversicherung (1,8% Arbeitnehmeranteil)
            careRateChildless: 4.8 / 100, // Pflegeversicherung f√ºr Kinderlose (1,8% + 0,6% = 2,4% Arbeitnehmeranteil)
            careRateReduction: 0.5 / 100, // Abschlag pro Kind ab dem 2. Kind (0,25% Arbeitnehmeranteil)
            
            // Beitragsbemessungsgrenzen 2025
            pensionCap: 96600, // Rentenversicherung (West) - 8.050 ‚Ç¨ √ó 12
            pensionCapEast: 93000, // Rentenversicherung (Ost) - 7.750 ‚Ç¨ √ó 12
            healthCap: 66150,  // Krankenversicherung - 5.512,50 ‚Ç¨ √ó 12
            
            // Kirchensteuers√§tze nach Bundesland
            churchTaxRates: {
                'bw': 0.08, 'by': 0.08, 'be': 0.09, 'bb': 0.09, 'hb': 0.09,
                'hh': 0.09, 'he': 0.09, 'mv': 0.09, 'ni': 0.09, 'nw': 0.09,
                'rp': 0.09, 'sl': 0.09, 'sn': 0.09, 'st': 0.09, 'sh': 0.09, 'th': 0.09
            },
            
            // Pauschbetr√§ge nach Steuerklasse
            taxClassAllowances: {
                '1': { werbungskosten: 1230, sonderausgaben: 36, vorsorgepauschale: 0 },
                '2': { werbungskosten: 1230, sonderausgaben: 36, vorsorgepauschale: 0, entlastung: 4260 },
                '3': { werbungskosten: 1230, sonderausgaben: 36, vorsorgepauschale: 0 },
                '4': { werbungskosten: 1230, sonderausgaben: 36, vorsorgepauschale: 0 },
                '5': { werbungskosten: 1230, sonderausgaben: 36, vorsorgepauschale: 0 },
                '6': { werbungskosten: 0, sonderausgaben: 0, vorsorgepauschale: 0 }
            },
            
            // Solidarit√§tszuschlag
            soliFreeLimit: 19950,  // Freigrenze f√ºr Einkommensteuer 2025
            soliRate: 0.055        // 5.5%
        };
        
        // Funktion zur Berechnung der Einkommensteuer nach Grundtabelle 2025
        function calculateIncomeTax(yearlyIncome, taxClass, children = 0, socialContributions = 0) {
            // Bruttoarbeitslohn minus Sozialversicherungsbeitr√§ge = zu versteuerndes Bruttoeinkommen
            let taxableGrossIncome = yearlyIncome - socialContributions;
            
            // Abzugsf√§hige Betr√§ge je nach Steuerklasse
            const allowances = taxConstants.taxClassAllowances[taxClass];
            let deductions = allowances.werbungskosten + allowances.sonderausgaben;
            
            // Kinderfreibetr√§ge hinzuf√ºgen
            const childDeduction = children * taxConstants.childAllowance;
            deductions += childDeduction;
            
            // Entlastungsbetrag f√ºr Alleinerziehende (Steuerklasse 2)
            if (taxClass === '2' && allowances.entlastung) {
                deductions += allowances.entlastung;
            }
            
            // Zu versteuerndes Einkommen berechnen
            let taxableIncome = Math.max(0, taxableGrossIncome - deductions);
            
            let tax = 0;
            
            // Progressive Steuerzonen nach Grundtabelle 2025
            if (taxableIncome <= taxConstants.basicAllowance) {
                tax = 0;
            } else if (taxableIncome <= taxConstants.taxZone2End) {
                // Zone 2: Progressionszone 1 (14% bis 24%) - 2025 angepasst
                const y = (taxableIncome - taxConstants.basicAllowance) / 10000;
                tax = (922.98 * y + 1400) * y;
            } else if (taxableIncome <= taxConstants.taxZone3End) {
                // Zone 3: Progressionszone 2 (24% bis 42%) - 2025 angepasst
                const z = (taxableIncome - taxConstants.taxZone3Start) / 10000;
                tax = (181.19 * z + 2397) * z + 1025.38;
            } else if (taxableIncome <= taxConstants.taxZone4End) {
                // Zone 4: Proportionalzone 1 (42%)
                tax = 0.42 * taxableIncome - 11294.68;
            } else {
                // Zone 5: Proportionalzone 2 (45%)
                tax = 0.45 * taxableIncome - 19619.93;
            }
            
            // Steuerklasse 3: Splittingtabelle (Ehegattensplitting)
            if (taxClass === '3') {
                // Bei Steuerklasse 3 wird die H√§lfte des Einkommens besteuert und dann verdoppelt
                const halfIncome = taxableIncome / 2;
                let halfTax = 0;
                
                if (halfIncome <= taxConstants.basicAllowance) {
                    halfTax = 0;
                } else if (halfIncome <= taxConstants.taxZone2End) {
                    const y = (halfIncome - taxConstants.basicAllowance) / 10000;
                    halfTax = (922.98 * y + 1400) * y;
                } else if (halfIncome <= taxConstants.taxZone3End) {
                    const z = (halfIncome - taxConstants.taxZone3Start) / 10000;
                    halfTax = (181.19 * z + 2397) * z + 1025.38;
                } else if (halfIncome <= taxConstants.taxZone4End) {
                    halfTax = 0.42 * halfIncome - 11294.68;
                } else {
                    halfTax = 0.45 * halfIncome - 19619.93;
                }
                
                tax = halfTax * 2;
            }
            
            // Steuerklasse 5: Erh√∂hte Besteuerung
            if (taxClass === '5') {
                tax *= 1.15; // Vereinfachte Erh√∂hung um 15%
            }
            
            // Steuerklasse 6: Keine Freibetr√§ge, h√∂chste Besteuerung
            if (taxClass === '6') {
                // Neuberechnung ohne Freibetr√§ge
                tax = 0;
                if (yearlyIncome <= 1000) {
                    tax = 0;
                } else if (yearlyIncome <= taxConstants.taxZone2End) {
                    const y = (yearlyIncome - 1000) / 10000;
                    tax = (922.98 * y + 1400) * y;
                } else if (yearlyIncome <= taxConstants.taxZone3End) {
                    const z = (yearlyIncome - taxConstants.taxZone3Start) / 10000;
                    tax = (181.19 * z + 2397) * z + 1025.38;
                } else if (yearlyIncome <= taxConstants.taxZone4End) {
                    tax = 0.42 * yearlyIncome - 11294.68;
                } else {
                    tax = 0.45 * yearlyIncome - 19619.93;
                }
            }
            
            return Math.max(0, Math.round(tax));
        }
        
        // Funktion zur Berechnung des Solidarit√§tszuschlags
        function calculateSolidarityTax(incomeTax) {
            // Solidarit√§tszuschlag 2025: Freigrenze bei 19.950 ‚Ç¨ Einkommensteuer
            const yearlyLimit = taxConstants.soliFreeLimit;
            
            if (incomeTax <= yearlyLimit) {
                return 0;
            }
            
            // Gleitzone zwischen 19.950 ‚Ç¨ und 34.595 ‚Ç¨
            const glideZoneEnd = yearlyLimit * 1.734; // ca. 34.595 ‚Ç¨
            if (incomeTax <= glideZoneEnd) {
                const excess = incomeTax - yearlyLimit;
                const rate = Math.min(0.055, excess * 0.119 / (glideZoneEnd - yearlyLimit));
                return excess * rate;
            }
            
            // Voller Satz ab 34.595 ‚Ç¨
            return incomeTax * taxConstants.soliRate;
        }
        
        // Funktion zur Berechnung der Kirchensteuer
        function calculateChurchTax(incomeTax, state, isChurchMember) {
            if (!isChurchMember) return 0;
            
            const rate = taxConstants.churchTaxRates[state];
            return incomeTax * rate;
        }
        
        // Funktion zur Berechnung der Krankenversicherung
        function calculateHealthInsurance(yearlyIncome, rate, additionalRate) {
            const cappedIncome = Math.min(yearlyIncome, taxConstants.healthCap);
            // Gesamtbeitragssatz: 14,6% + Zusatzbeitrag (durchschnittlich 2,5%)
            // Arbeitnehmeranteil: 7,3% + 1,25% = 8,55% (wird aber durch rate/2 berechnet)
            const totalRate = (rate + additionalRate) / 100;
            
            return cappedIncome * (totalRate / 2); // Arbeitnehmeranteil
        }
        
        // Funktion zur Berechnung der Pflegeversicherung 2025
        function calculateCareInsurance(yearlyIncome, children) {
            const cappedIncome = Math.min(yearlyIncome, taxConstants.healthCap);
            let rate = taxConstants.careRateChildless; // 2,4% f√ºr Kinderlose (Arbeitnehmeranteil)
            
            // Mit Kindern: Grundbeitrag 1,8% (Arbeitnehmeranteil)
            if (children > 0) {
                rate = taxConstants.careRate;
                
                // Ab dem 2. Kind gibt es weitere Abschl√§ge (0,25% pro Kind bis max. 1%)
                if (children >= 2) {
                    const reduction = Math.min((children - 1) * taxConstants.careRateReduction, 0.02);
                    rate = Math.max(rate - reduction, 0.018); // Mindestens 1,8%
                }
            }
            
            return cappedIncome * (rate / 2); // Bereits Arbeitnehmeranteil
        }
        
        // Funktion zur Berechnung der Rentenversicherung
        function calculatePensionInsurance(yearlyIncome) {
            const cappedIncome = Math.min(yearlyIncome, taxConstants.pensionCap);
            return cappedIncome * (taxConstants.pensionRate / 2); // Arbeitnehmeranteil
        }
        
        // Funktion zur Berechnung der Arbeitslosenversicherung
        function calculateUnemploymentInsurance(yearlyIncome) {
            const cappedIncome = Math.min(yearlyIncome, taxConstants.pensionCap);
            return cappedIncome * (taxConstants.unemploymentRate / 2); // Arbeitnehmeranteil
        }
        
        // Funktion zum Formatieren von W√§hrungsbetr√§gen
        function formatCurrency(amount) {
            return new Intl.NumberFormat('de-DE', { 
                style: 'currency', 
                currency: 'EUR',
                maximumFractionDigits: 2
            }).format(amount);
        }
        
        // Funktion zum Formatieren von Prozents√§tzen
        function formatPercent(amount) {
            return new Intl.NumberFormat('de-DE', { 
                style: 'percent', 
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }
        
        // Hauptfunktion zur Berechnung aller Werte
        function calculateAll() {
            // Eingabewerte auslesen
            const activeTab = document.querySelector('.tab.active').getAttribute('data-tab');
            
            let yearlyGross, monthlyGross;
            
            if (activeTab === 'monthly') {
                monthlyGross = parseFloat(document.getElementById('monthly-salary').value);
                yearlyGross = monthlyGross * 12;
            } else {
                yearlyGross = parseFloat(document.getElementById('yearly-salary').value);
                monthlyGross = yearlyGross / 12;
            }
            
            const taxClass = document.getElementById('tax-class').value;
            const state = document.getElementById('state').value;
            const children = parseInt(document.getElementById('children').value);
            const isChurchMember = document.getElementById('church-tax').value === '1';
            const healthRate = parseFloat(document.getElementById('health-insurance').value);
            const additionalHealthRate = parseFloat(document.getElementById('additional-health').value);
            
            // Erst Sozialabgaben berechnen
            const yearlyHealth = calculateHealthInsurance(yearlyGross, healthRate, additionalHealthRate);
            const yearlyCare = calculateCareInsurance(yearlyGross, children);
            const yearlyPension = calculatePensionInsurance(yearlyGross);
            const yearlyUnemployment = calculateUnemploymentInsurance(yearlyGross);
            
            const totalSocialContributions = yearlyHealth + yearlyCare + yearlyPension + yearlyUnemployment;
            
            // Dann Einkommensteuer mit Sozialabgaben-Abzug berechnen
            const yearlyIncomeTax = calculateIncomeTax(yearlyGross, taxClass, children, totalSocialContributions);
            const yearlySolidarity = calculateSolidarityTax(yearlyIncomeTax);
            const yearlyChurch = calculateChurchTax(yearlyIncomeTax, state, isChurchMember);
            
            const yearlyTotalDeductions = yearlyIncomeTax + yearlySolidarity + yearlyChurch + 
                                       yearlyHealth + yearlyCare + yearlyPension + yearlyUnemployment;
            
            const yearlyNet = yearlyGross - yearlyTotalDeductions;
            
            // Monatliche Werte berechnen
            const monthlyIncomeTax = yearlyIncomeTax / 12;
            const monthlySolidarity = yearlySolidarity / 12;
            const monthlyChurch = yearlyChurch / 12;
            const monthlyHealth = yearlyHealth / 12;
            const monthlyCare = yearlyCare / 12;
            const monthlyPension = yearlyPension / 12;
            const monthlyUnemployment = yearlyUnemployment / 12;
            const monthlyTotalDeductions = yearlyTotalDeductions / 12;
            const monthlyNet = yearlyNet / 12;
            
            // Abgabenquote berechnen
            const deductionRate = yearlyTotalDeductions / yearlyGross;
            
            // Ergebnisse anzeigen - Monatlich
            document.getElementById('monthly-gross').textContent = formatCurrency(monthlyGross);
            document.getElementById('monthly-income-tax').textContent = formatCurrency(monthlyIncomeTax);
            document.getElementById('monthly-solidarity').textContent = formatCurrency(monthlySolidarity);
            document.getElementById('monthly-church').textContent = formatCurrency(monthlyChurch);
            document.getElementById('monthly-health').textContent = formatCurrency(monthlyHealth);
            document.getElementById('monthly-care').textContent = formatCurrency(monthlyCare);
            document.getElementById('monthly-pension').textContent = formatCurrency(monthlyPension);
            document.getElementById('monthly-unemployment').textContent = formatCurrency(monthlyUnemployment);
            document.getElementById('monthly-total-deductions').textContent = formatCurrency(monthlyTotalDeductions);
            document.getElementById('monthly-net').textContent = formatCurrency(monthlyNet);
            
            // Ergebnisse anzeigen - J√§hrlich
            document.getElementById('yearly-gross').textContent = formatCurrency(yearlyGross);
            document.getElementById('yearly-income-tax').textContent = formatCurrency(yearlyIncomeTax);
            document.getElementById('yearly-solidarity').textContent = formatCurrency(yearlySolidarity);
            document.getElementById('yearly-church').textContent = formatCurrency(yearlyChurch);
            document.getElementById('yearly-health').textContent = formatCurrency(yearlyHealth);
            document.getElementById('yearly-care').textContent = formatCurrency(yearlyCare);
            document.getElementById('yearly-pension').textContent = formatCurrency(yearlyPension);
            document.getElementById('yearly-unemployment').textContent = formatCurrency(yearlyUnemployment);
            document.getElementById('yearly-total-deductions').textContent = formatCurrency(yearlyTotalDeductions);
            document.getElementById('yearly-net').textContent = formatCurrency(yearlyNet);
            
            // Abgabenquote anzeigen
            document.getElementById('deduction-rate').textContent = formatPercent(deductionRate);
        }
        
        // Event-Listener f√ºr den Berechnen-Button
        document.getElementById('calculate-btn').addEventListener('click', calculateAll);
        
        // Initialisierung
        document.addEventListener('DOMContentLoaded', calculateAll);
    </script>
</body>
</html>